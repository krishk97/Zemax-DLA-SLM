(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16492,        396]
NotebookOptionsPosition[     15697,        368]
NotebookOutlinePosition[     16043,        383]
CellTagsIndexPosition[     16000,        380]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], "//", "Quiet"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Parameters", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]", " ", "=", " ", "800*^-9"}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]", "=", 
   RowBox[{"28.65", "*", 
    FractionBox["\[Pi]", "180"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wx1", " ", "=", " ", 
   RowBox[{"0.5", " ", "*", "31.75*^-3", " ", "*", " ", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wx2", "=", 
   RowBox[{"0.5", "*", "44.45*^-3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wy1", "=", 
   RowBox[{"0.5", "*", "63.5*^-3", " ", "*", " ", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wy2", "=", 
   RowBox[{"0.5", "*", "76.2*^-3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zR", " ", "=", " ", 
   FractionBox[
    RowBox[{"\[Pi]", " ", 
     SuperscriptBox["w0", "2"]}], "\[Lambda]"]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"wx1", "*", 
  RowBox[{"10", "^", "3"}]}], "\[IndentingNewLine]", 
 RowBox[{"wy1", "*", 
  RowBox[{"10", "^", "3"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solnx", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wx1", "\[Equal]", " ", 
         RowBox[{"w0", 
          SqrtBox[
           RowBox[{"1", "+", 
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox["z", "zR"], ")"}], "2"]}]]}]}], "&&", 
        RowBox[{"wx2", "\[Equal]", " ", 
         RowBox[{"w0", 
          SqrtBox[
           RowBox[{"1", "+", 
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox[
               RowBox[{"z", "+", "1202.43*^-3"}], "zR"], ")"}], "2"]}]]}]}]}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", "w0"}], "}"}]}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"solny", "=", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"wy1", "\[Equal]", " ", 
          RowBox[{"w0", 
           SqrtBox[
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               FractionBox["z", "zR"], ")"}], "2"]}]]}]}], "&&", 
         RowBox[{"wy2", "\[Equal]", " ", 
          RowBox[{"w0", 
           SqrtBox[
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               FractionBox[
                RowBox[{"z", "+", "1202.43*^-3"}], "zR"], ")"}], 
              "2"]}]]}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", "w0"}], "}"}]}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w0x", "=", 
   RowBox[{"w0", "/.", "solnx"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w0y", "=", 
   RowBox[{"w0", "/.", "solny"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z0x", "=", 
   RowBox[{
    RowBox[{"-", "z"}], "/.", "solnx"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z0y", "=", 
    RowBox[{
     RowBox[{"-", "z"}], "/.", "solny"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<w0x,w0y,z0x,z0y in mm\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w0x", "*", 
   SuperscriptBox["10", "3"]}], "//", 
  "ScientificForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w0y", "*", 
   SuperscriptBox["10", "3"]}], "//", 
  "ScientificForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z0x", "*", 
   SuperscriptBox["10", "3"]}], "//", 
  "ScientificForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z0y", "*", 
    SuperscriptBox["10", "3"]}], "//", "ScientificForm"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<\[Theta]x,\[Theta]y in deg\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"\[Theta]x", "=", 
  RowBox[{
   RowBox[{
    FractionBox["\[Lambda]", 
     RowBox[{"\[Pi]", " ", "w0x"}]], "*", 
    FractionBox["180", "\[Pi]"]}], "//", 
   "ScientificForm"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]y", "=", 
   RowBox[{
    RowBox[{
     FractionBox["\[Lambda]", 
      RowBox[{"\[Pi]", " ", "w0y"}]], "*", 
     FractionBox["180", "\[Pi]"]}], "//", "ScientificForm"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Rayleigh range at grating\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ry", " ", "=", " ", 
   RowBox[{"z0y", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         FractionBox[
          RowBox[{"\[Pi]", " ", 
           SuperscriptBox["w0y", "2"]}], "\[Lambda]"], "z0y"], ")"}], "2"]}], 
     ")"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7413654977747707`*^9, 3.7413655205380726`*^9}, {
   3.7413664444579177`*^9, 3.7413664681772747`*^9}, {3.74136651775311*^9, 
   3.7413665256895638`*^9}, {3.74136656234566*^9, 3.7413665890251865`*^9}, {
   3.7413671859453287`*^9, 3.7413672026972866`*^9}, {3.7413672327530055`*^9, 
   3.741367452750589*^9}, {3.7413675185893545`*^9, 3.7413676162509403`*^9}, {
   3.741972184966094*^9, 3.7419721954186916`*^9}, {3.7419722471876526`*^9, 
   3.7419723261911716`*^9}, {3.74197237337187*^9, 3.741972415459277*^9}, {
   3.741973175845769*^9, 3.7419731796119843`*^9}, {3.74232451885844*^9, 
   3.7423245228406677`*^9}, {3.742324819813654*^9, 3.7423248568247705`*^9}, {
   3.742324892608817*^9, 3.742324897112075*^9}, {3.7423250795825114`*^9, 
   3.742325079886529*^9}, 3.742326080066736*^9, {3.742326174618144*^9, 
   3.742326205514911*^9}, {3.742326314193127*^9, 3.7423263762606773`*^9}, {
   3.742326410824654*^9, 3.742326411696704*^9}, {3.742326451160961*^9, 
   3.7423264577103357`*^9}, {3.742326487960066*^9, 3.742326489465152*^9}, {
   3.7423265277763433`*^9, 3.7423265418721495`*^9}, {3.742326660983962*^9, 
   3.7423267148320427`*^9}, {3.742326808416395*^9, 3.742326889815051*^9}, {
   3.7423278494949417`*^9, 3.7423278904112816`*^9}, {3.7423279912560496`*^9, 
   3.742327993671188*^9}, {3.7423280940229273`*^9, 3.7423281388334904`*^9}, {
   3.7423281734024677`*^9, 3.7423282447315474`*^9}, {3.7423282752112913`*^9, 
   3.742328275299296*^9}, {3.7423283368498163`*^9, 3.7423283660594873`*^9}, {
   3.7423284546665554`*^9, 3.7423285452027335`*^9}, {3.742328600803914*^9, 
   3.7423287215798216`*^9}, {3.7423318134126644`*^9, 
   3.7423318159248085`*^9}, {3.742331888620966*^9, 3.7423319167245736`*^9}, {
   3.7427427467975864`*^9, 3.742742847370963*^9}, {3.742742901986659*^9, 
   3.7427434875492873`*^9}, {3.742743586469061*^9, 3.7427436225987244`*^9}, {
   3.742743661598793*^9, 3.74274369944446*^9}, {3.7428268024958353`*^9, 
   3.742826825876173*^9}, {3.7428281173880434`*^9, 3.742828164610744*^9}, {
   3.742828385050352*^9, 3.7428285049662113`*^9}, {3.742830967044034*^9, 
   3.742830967514061*^9}, {3.7428325312835035`*^9, 3.74283254241114*^9}}],

Cell[BoxData["13.93134284653451`"], "Output",
 CellChangeTimes->{{3.74232852048532*^9, 3.7423285458597713`*^9}, {
   3.7423286748131466`*^9, 3.742328722912898*^9}, 3.742331821842147*^9, {
   3.7423318899950447`*^9, 3.7423319253930693`*^9}, {3.7427432609432893`*^9, 
   3.7427433219861965`*^9}, {3.7427434159919615`*^9, 3.742743450062422*^9}, 
   3.742743488282489*^9, {3.7427436031298904`*^9, 3.7427436247671285`*^9}, 
   3.742743702174464*^9, {3.7428268175366955`*^9, 3.742826828865344*^9}, 
   3.7428284726783648`*^9, 3.742830969806192*^9, {3.7428325320145454`*^9, 
   3.742832543342193*^9}}],

Cell[BoxData["27.86268569306902`"], "Output",
 CellChangeTimes->{{3.74232852048532*^9, 3.7423285458597713`*^9}, {
   3.7423286748131466`*^9, 3.742328722912898*^9}, 3.742331821842147*^9, {
   3.7423318899950447`*^9, 3.7423319253930693`*^9}, {3.7427432609432893`*^9, 
   3.7427433219861965`*^9}, {3.7427434159919615`*^9, 3.742743450062422*^9}, 
   3.742743488282489*^9, {3.7427436031298904`*^9, 3.7427436247671285`*^9}, 
   3.742743702174464*^9, {3.7428268175366955`*^9, 3.742826828865344*^9}, 
   3.7428284726783648`*^9, 3.742830969806192*^9, {3.7428325320145454`*^9, 
   3.7428325433441935`*^9}}],

Cell[BoxData["\<\"w0x,w0y,z0x,z0y in mm\"\>"], "Print",
 CellChangeTimes->{{3.7427432609276896`*^9, 3.742743322017397*^9}, {
   3.7427434160075617`*^9, 3.742743450062422*^9}, 3.7427434882668886`*^9, {
   3.7427436031610904`*^9, 3.7427436247983284`*^9}, 3.7427437022056646`*^9, {
   3.7428268175866985`*^9, 3.7428268288963456`*^9}, 3.7428284727083664`*^9, 
   3.7428309698351936`*^9, {3.742832532044547*^9, 3.7428325433731947`*^9}}],

Cell[BoxData[
 TagBox[
  InterpretationBox[
   RowBox[{"\<\"3.69193\"\>", "\[Times]", 
    SuperscriptBox["10", "\<\"-2\"\>"]}],
   0.03691925112382445,
   AutoDelete->True],
  ScientificForm]], "Output",
 CellChangeTimes->{{3.74232852048532*^9, 3.7423285458597713`*^9}, {
   3.7423286748131466`*^9, 3.742328722912898*^9}, 3.742331821842147*^9, {
   3.7423318899950447`*^9, 3.7423319253930693`*^9}, {3.7427432609432893`*^9, 
   3.7427433219861965`*^9}, {3.7427434159919615`*^9, 3.742743450062422*^9}, 
   3.742743488282489*^9, {3.7427436031298904`*^9, 3.7427436247671285`*^9}, 
   3.742743702174464*^9, {3.7428268175366955`*^9, 3.742826828865344*^9}, 
   3.7428284726783648`*^9, 3.742830969806192*^9, {3.7428325320145454`*^9, 
   3.742832543374195*^9}}],

Cell[BoxData[
 TagBox[
  InterpretationBox[
   RowBox[{"\<\"2.99098\"\>", "\[Times]", 
    SuperscriptBox["10", "\<\"-2\"\>"]}],
   0.029909812960429046`,
   AutoDelete->True],
  ScientificForm]], "Output",
 CellChangeTimes->{{3.74232852048532*^9, 3.7423285458597713`*^9}, {
   3.7423286748131466`*^9, 3.742328722912898*^9}, 3.742331821842147*^9, {
   3.7423318899950447`*^9, 3.7423319253930693`*^9}, {3.7427432609432893`*^9, 
   3.7427433219861965`*^9}, {3.7427434159919615`*^9, 3.742743450062422*^9}, 
   3.742743488282489*^9, {3.7427436031298904`*^9, 3.7427436247671285`*^9}, 
   3.742743702174464*^9, {3.7428268175366955`*^9, 3.742826828865344*^9}, 
   3.7428284726783648`*^9, 3.742830969806192*^9, {3.7428325320145454`*^9, 
   3.7428325433771954`*^9}}],

Cell[BoxData[
 TagBox[
  InterpretationBox[
   RowBox[{"\<\"-2.01978\"\>", "\[Times]", 
    SuperscriptBox["10", "\<\"3\"\>"]}],
   -2019.780728191889,
   AutoDelete->True],
  ScientificForm]], "Output",
 CellChangeTimes->{{3.74232852048532*^9, 3.7423285458597713`*^9}, {
   3.7423286748131466`*^9, 3.742328722912898*^9}, 3.742331821842147*^9, {
   3.7423318899950447`*^9, 3.7423319253930693`*^9}, {3.7427432609432893`*^9, 
   3.7427433219861965`*^9}, {3.7427434159919615`*^9, 3.742743450062422*^9}, 
   3.742743488282489*^9, {3.7427436031298904`*^9, 3.7427436247671285`*^9}, 
   3.742743702174464*^9, {3.7428268175366955`*^9, 3.742826828865344*^9}, 
   3.7428284726783648`*^9, 3.742830969806192*^9, {3.7428325320145454`*^9, 
   3.742832543379195*^9}}],

Cell[BoxData[
 TagBox[
  InterpretationBox[
   RowBox[{"\<\"-3.27263\"\>", "\[Times]", 
    SuperscriptBox["10", "\<\"3\"\>"]}],
   -3272.6254888107205`,
   AutoDelete->True],
  ScientificForm]], "Output",
 CellChangeTimes->{{3.74232852048532*^9, 3.7423285458597713`*^9}, {
   3.7423286748131466`*^9, 3.742328722912898*^9}, 3.742331821842147*^9, {
   3.7423318899950447`*^9, 3.7423319253930693`*^9}, {3.7427432609432893`*^9, 
   3.7427433219861965`*^9}, {3.7427434159919615`*^9, 3.742743450062422*^9}, 
   3.742743488282489*^9, {3.7427436031298904`*^9, 3.7427436247671285`*^9}, 
   3.742743702174464*^9, {3.7428268175366955`*^9, 3.742826828865344*^9}, 
   3.7428284726783648`*^9, 3.742830969806192*^9, {3.7428325320145454`*^9, 
   3.742832543381195*^9}}],

Cell[BoxData["\<\"\[Theta]x,\[Theta]y in deg\"\>"], "Print",
 CellChangeTimes->{{3.7427432609276896`*^9, 3.742743322017397*^9}, {
   3.7427434160075617`*^9, 3.742743450062422*^9}, 3.7427434882668886`*^9, {
   3.7427436031610904`*^9, 3.7427436247983284`*^9}, 3.7427437022056646`*^9, {
   3.7428268175866985`*^9, 3.7428268288963456`*^9}, 3.7428284727083664`*^9, 
   3.7428309698351936`*^9, {3.742832532044547*^9, 3.7428325433821955`*^9}}],

Cell[BoxData[
 TagBox[
  InterpretationBox[
   RowBox[{"\<\"3.95194\"\>", "\[Times]", 
    SuperscriptBox["10", "\<\"-1\"\>"]}],
   0.39519356434294983`,
   AutoDelete->True],
  ScientificForm]], "Output",
 CellChangeTimes->{{3.74232852048532*^9, 3.7423285458597713`*^9}, {
   3.7423286748131466`*^9, 3.742328722912898*^9}, 3.742331821842147*^9, {
   3.7423318899950447`*^9, 3.7423319253930693`*^9}, {3.7427432609432893`*^9, 
   3.7427433219861965`*^9}, {3.7427434159919615`*^9, 3.742743450062422*^9}, 
   3.742743488282489*^9, {3.7427436031298904`*^9, 3.7427436247671285`*^9}, 
   3.742743702174464*^9, {3.7428268175366955`*^9, 3.742826828865344*^9}, 
   3.7428284726783648`*^9, 3.742830969806192*^9, {3.7428325320145454`*^9, 
   3.7428325433841953`*^9}}],

Cell[BoxData[
 TagBox[
  InterpretationBox[
   RowBox[{"\<\"4.87808\"\>", "\[Times]", 
    SuperscriptBox["10", "\<\"-1\"\>"]}],
   0.4878081472391578,
   AutoDelete->True],
  ScientificForm]], "Output",
 CellChangeTimes->{{3.74232852048532*^9, 3.7423285458597713`*^9}, {
   3.7423286748131466`*^9, 3.742328722912898*^9}, 3.742331821842147*^9, {
   3.7423318899950447`*^9, 3.7423319253930693`*^9}, {3.7427432609432893`*^9, 
   3.7427433219861965`*^9}, {3.7427434159919615`*^9, 3.742743450062422*^9}, 
   3.742743488282489*^9, {3.7427436031298904`*^9, 3.7427436247671285`*^9}, 
   3.742743702174464*^9, {3.7428268175366955`*^9, 3.742826828865344*^9}, 
   3.7428284726783648`*^9, 3.742830969806192*^9, {3.7428325320145454`*^9, 
   3.7428325433861957`*^9}}],

Cell[BoxData["\<\"Rayleigh range at grating\"\>"], "Print",
 CellChangeTimes->{{3.7427432609276896`*^9, 3.742743322017397*^9}, {
   3.7427434160075617`*^9, 3.742743450062422*^9}, 3.7427434882668886`*^9, {
   3.7427436031610904`*^9, 3.7427436247983284`*^9}, 3.7427437022056646`*^9, {
   3.7428268175866985`*^9, 3.7428268288963456`*^9}, 3.7428284727083664`*^9, 
   3.7428309698351936`*^9, {3.742832532044547*^9, 3.742832543388196*^9}}],

Cell[BoxData[
 RowBox[{"-", "3.272629259999314`"}]], "Output",
 CellChangeTimes->{{3.74232852048532*^9, 3.7423285458597713`*^9}, {
   3.7423286748131466`*^9, 3.742328722912898*^9}, 3.742331821842147*^9, {
   3.7423318899950447`*^9, 3.7423319253930693`*^9}, {3.7427432609432893`*^9, 
   3.7427433219861965`*^9}, {3.7427434159919615`*^9, 3.742743450062422*^9}, 
   3.742743488282489*^9, {3.7427436031298904`*^9, 3.7427436247671285`*^9}, 
   3.742743702174464*^9, {3.7428268175366955`*^9, 3.742826828865344*^9}, 
   3.7428284726783648`*^9, 3.742830969806192*^9, {3.7428325320145454`*^9, 
   3.742832543389196*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.741367402677725*^9, 3.7413674035127726`*^9}}]
},
WindowSize->{767, 873},
WindowMargins->{{Automatic, 568}, {44, Automatic}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 7341, 186, 951, "Input"],
Cell[7924, 210, 594, 8, 31, "Output"],
Cell[8521, 220, 596, 8, 31, "Output"],
Cell[9120, 230, 431, 5, 23, "Print"],
Cell[9554, 237, 753, 15, 45, "Output"],
Cell[10310, 254, 757, 15, 45, "Output"],
Cell[11070, 271, 752, 15, 45, "Output"],
Cell[11825, 288, 754, 15, 45, "Output"],
Cell[12582, 305, 436, 5, 23, "Print"],
Cell[13021, 312, 756, 15, 45, "Output"],
Cell[13780, 329, 754, 15, 45, "Output"],
Cell[14537, 346, 433, 5, 23, "Print"],
Cell[14973, 353, 611, 9, 64, "Output"]
}, Open  ]],
Cell[15599, 365, 94, 1, 31, "Input"]
}
]
*)

(* End of internal cache information *)
